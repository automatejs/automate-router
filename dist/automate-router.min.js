!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.automateRouter=e():t.automateRouter=e()}(window,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function o(t){return t.toString().replace(/\/$/,"").replace(/^\//,"")}n.r(e);var r,i=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.route=e,this.parameters={},this.matchedPath="",this.remainingPath="",this.new=!0};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function f(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p,h=automate.service({namespace:"automate",key:"hashProvider"})(r=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=a(this,c(e).call(this))).listener=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,automate.Service),f(e,[{key:"path",get:function(){return location.hash.substr(1)}}]),f(e,[{key:"navigate",value:function(t){t=t||"",location.hash=t}},{key:"listen",value:function(t){var e=this;this.listener=function(){t.call(e,e.path)},window.addEventListener("hashchange",this.listener),t.call(e,e.path)}},{key:"stop",value:function(){window.removeEventListener("hashchange",this.listener)}}]),e}())||r;function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){return!e||"object"!==y(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function w(t,e,n){return e&&m(t.prototype,e),n&&m(t,n),t}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g,O=automate.service({namespace:"automate",key:"historyProvider"})(p=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=b(this,v(e).call(this))).base="/",t.current="",t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(e,automate.Service),w(e,[{key:"path",get:function(){var t=location.pathname+location.search;return t=(t=o(t=decodeURI(t))).replace(/\?(.*)$/,""),"/"===this.base?t:t.replace(this.base,"")}}]),w(e,[{key:"config",value:function(t){t.base&&(this.base="/"+o(t.base)+"/")}},{key:"listen",value:function(t){var e=this;this.current=this.path,clearInterval(this.interval),this.interval=setInterval((function(){e.current!==e.path&&(e.current=e.path,t.call(e,e.current))}),50)}},{key:"navigate",value:function(t){t=t||"",history.pushState(null,null,this.base+o(t))}},{key:"stop",value:function(){clearInterval(this.interval)}}]),e}())||p;function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _(t,e){return!e||"object"!==j(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var R,C=automate.service({namespace:"automate",key:"routerService",inject:{$hash:h,$history:O,$injector:"injector"}})(g=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=_(this,k(e).call(this))).settings={},t.provider=null,t.mode="hash",t.routes=[],t.currentRouteStates=[],t.routeChange=new automate.Message,t}var n,r,u;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(e,automate.Service),n=e,(r=[{key:"config",value:function(t,e){this.routes=t,e&&("history"===e.mode&&history.pushState&&(this.mode="history"),this.settings=automate.merge({namespace:"automate",using:{}},e)),"history"===this.mode?(this.$history.settings(e),this.provider=this.$history):this.provider=this.$hash}},{key:"add",value:function(t){this.routes.push(t)}},{key:"remove",value:function(t){automate.remove(this.routes,t)}},{key:"map",value:function(t){var e,n=this.currentRouteStates;t=o(t),this.currentRouteStates=[],this.matchRoutes(this.routes,t,n),this.currentRouteStates.some((function(t,n){if(t.new)return e={depth:n,state:t},!0})),this.currentRouteStates.forEach((function(t){t.new=!1})),this.routeChange.fire(e)}},{key:"matchRoutes",value:function(t,e,n){if(t&&t.length){var o=this;t.some((function(t){var r=o.matchRoute(t,e);if(r){if(n.length){var i=n.shift();r.route===i.route?o.currentRouteStates.push(i):o.currentRouteStates.push(r)}else o.currentRouteStates.push(r);return o.matchRoutes(t.children,r.remainingPath,n),!0}}))}}},{key:"matchRoute",value:function(t,e){for(var n=new i(t),o=[],r=t.path.split("/"),u=e.split("/"),a=0;a<r.length;a++){var c=r[a];if(a>=u.length)return null;var s=u[a];if(c===s)o.push(s);else{if(!c.startsWith(":"))return null;o.push(s),n.parameters[c.substring(1)]=s}}return n.matchedPath=o.join("/"),n.remainingPath=u.splice(r.length).join("/"),n}},{key:"listen",value:function(){var t=this;this.provider.listen((function(e){t.map(e)}))}},{key:"navigate",value:function(t){this.provider.navigate(t||"")}},{key:"stop",value:function(){this.provider.stop()}},{key:"watchRouteChange",value:function(t,e){var n=this;function o(o){o.data.depth===t&&e({component:n.resolveComponent(o.data.state.route.component),state:o.data.state})}return this.routeChange.on(o),function(){this.routeChange.off(o)}}},{key:"resolveComponent",value:function(t){return this.$injector.parseComponent(t,this.settings.using,this.settings.namespace)}}])&&S(n.prototype,r),u&&S(n,u),e}())||g;function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function x(t,e){return!e||"object"!==$(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var V;automate.component({namespace:"automate",key:"routerLink",template:'<span class="link" style="cursor: pointer;" @click="navigate()"><slot name="content"></slot></span>',inject:{$router:C}})(R=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=x(this,T(e).call(this))).props.to="",t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D(t,e)}(e,automate.Component),n=e,(o=[{key:"navigate",value:function(){this.$router.navigate(this.props.to)}}])&&E(n.prototype,o),r&&E(n,r),e}());function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function I(t,e){return!e||"object"!==M(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function N(t,e){return(N=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}automate.component({namespace:"automate",key:"routerView",inject:{$router:C}})(V=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=I(this,L(e).call(this))).view=null,t.viewDepth=0,t.unWatchRouteChange=null,t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&N(t,e)}(e,automate.Component),n=e,(o=[{key:"afterViewRendered",value:function(){var t=this;automate.isNumber(this.$$parent.viewDepth)&&(this.viewDepth=this.$$parent.viewDepth+1),this.unWatchRouteChange=this.$router.watchRouteChange(this.viewDepth,(function(e){return t.updateView(e)})),0===this.viewDepth&&this.$router.listen()}},{key:"updateView",value:function(t){this.clearView(),this.renderView(t.component)}},{key:"clearView",value:function(){null!=this.view&&(this.view.$destroy(),this.view=null)}},{key:"renderView",value:function(t){this.view=automate.injector.createComponent(t),this.view.viewDepth=this.viewDepth+1,this.view.$mount(this.$container),this.view.$render()}},{key:"onDestroy",value:function(){this.unWatchRouteChange&&this.unWatchRouteChange(),this.clearView()}}])&&W(n.prototype,o),r&&W(n,r),e}());n.d(e,"RouterService",(function(){return C}))}])}));